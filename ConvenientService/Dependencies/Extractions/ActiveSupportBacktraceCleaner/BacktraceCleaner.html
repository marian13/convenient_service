<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: ConvenientService::Dependencies::Extractions::ActiveSupportBacktraceCleaner::BacktraceCleaner
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "ConvenientService::Dependencies::Extractions::ActiveSupportBacktraceCleaner::BacktraceCleaner";
  relpath = '../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../ConvenientService.html" title="ConvenientService (module)">ConvenientService</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Dependencies.html" title="ConvenientService::Dependencies (module)">Dependencies</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Extractions.html" title="ConvenientService::Dependencies::Extractions (module)">Extractions</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../ActiveSupportBacktraceCleaner.html" title="ConvenientService::Dependencies::Extractions::ActiveSupportBacktraceCleaner (module)">ActiveSupportBacktraceCleaner</a></span></span>
     &raquo; 
    <span class="title">BacktraceCleaner</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: ConvenientService::Dependencies::Extractions::ActiveSupportBacktraceCleaner::BacktraceCleaner
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ConvenientService::Dependencies::Extractions::ActiveSupportBacktraceCleaner::BacktraceCleaner</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/convenient_service/dependencies/extractions/active_support_backtrace_cleaner/backtrace_cleaner.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Backtraces often include many lines that are not relevant for the context
under review. This makes it hard to find the signal amongst the backtrace
noise, and adds debugging time. With a BacktraceCleaner, filters and
silencers are used to remove the noisy lines, so that only the most relevant
lines remain.</p>
<p>Filters are used to modify lines of data, while silencers are used to remove
lines entirely. The typical filter use case is to remove lengthy path
information from the start of each line, and view file paths relevant to the
app directory instead of the file system root. The typical silencer use case
is to exclude the output of a noisy library from the backtrace, so that you
can focus on the rest.</p>
<p>bc = ActiveSupport::BacktraceCleaner.new
bc.add_filter   { |line| line.gsub(Rails.root.to_s, '') } # strip the Rails.root prefix
bc.add_silencer { |line| /puma|rubygems/.match?(line) } # skip any lines from puma or rubygems
bc.clean(exception.backtrace) # perform the cleanup</p>
<p>To reconfigure an existing BacktraceCleaner (like the default one in Rails)
and show as much data as possible, you can always call
BacktraceCleaner#remove_silencers!, which will restore the
backtrace to a pristine state. If you need to reconfigure an existing
BacktraceCleaner so that it does not filter or modify the paths of any lines
of the backtrace, you can call BacktraceCleaner#remove_filters!
These two methods will give you a completely untouched backtrace.</p>
<p>Inspired by the Quiet Backtrace gem by thoughtbot.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_filter-instance_method" title="#add_filter (instance method)">#<strong>add_filter</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Adds a filter from the block provided.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_silencer-instance_method" title="#add_silencer (instance method)">#<strong>add_silencer</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Adds a silencer from the block provided.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clean-instance_method" title="#clean (instance method)">#<strong>clean</strong>(backtrace, kind = :silent)  &#x21d2; Object </a>
    

    
      (also: #filter)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the backtrace after all filters and silencers have been run against it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; BacktraceCleaner </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of BacktraceCleaner.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_filters!-instance_method" title="#remove_filters! (instance method)">#<strong>remove_filters!</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Removes all filters, but leaves in the silencers.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_silencers!-instance_method" title="#remove_silencers! (instance method)">#<strong>remove_silencers!</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Removes all silencers, but leaves in the filters.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="ConvenientService::Dependencies::Extractions::ActiveSupportBacktraceCleaner::BacktraceCleaner (class)">BacktraceCleaner</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of BacktraceCleaner.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49
50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_backtrace_cleaner/backtrace_cleaner.rb', line 47</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@filters</span><span class='comma'>,</span> <span class='ivar'>@silencers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_add_gem_filter'>add_gem_filter</span>
  <span class='id identifier rubyid_add_gem_silencer'>add_gem_silencer</span>
  <span class='id identifier rubyid_add_stdlib_silencer'>add_stdlib_silencer</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_filter-instance_method">
  
    #<strong>add_filter</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Adds a filter from the block provided. Each line in the backtrace will be
mapped against this filter.</p>
<h1>Will turn &quot;/my/rails/root/app/models/person.rb&quot; into &quot;/app/models/person.rb&quot;</h1>
<p>backtrace_cleaner.add_filter { |line| line.gsub(Rails.root, '') }</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_backtrace_cleaner/backtrace_cleaner.rb', line 75</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_filter'>add_filter</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@filters</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_silencer-instance_method">
  
    #<strong>add_silencer</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Adds a silencer from the block provided. If the silencer returns +true+
for a given line, it will be excluded from the clean backtrace.</p>
<h1>Will reject all lines that include the word &quot;puma&quot;, like &quot;/gems/puma/server.rb&quot; or &quot;/app/my_puma_server/rb&quot;</h1>
<p>backtrace_cleaner.add_silencer { |line| /puma/.match?(line) }</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_backtrace_cleaner/backtrace_cleaner.rb', line 84</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_silencer'>add_silencer</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@silencers</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="clean-instance_method">
  
    #<strong>clean</strong>(backtrace, kind = :silent)  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='filter-instance_method'>filter</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the backtrace after all filters and silencers have been run
against it. Filters run first, then silencers.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_backtrace_cleaner/backtrace_cleaner.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_clean'>clean</span><span class='lparen'>(</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='comma'>,</span> <span class='id identifier rubyid_kind'>kind</span> <span class='op'>=</span> <span class='symbol'>:silent</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_filtered'>filtered</span> <span class='op'>=</span> <span class='id identifier rubyid_filter_backtrace'>filter_backtrace</span><span class='lparen'>(</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='rparen'>)</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_kind'>kind</span>
  <span class='kw'>when</span> <span class='symbol'>:silent</span>
    <span class='id identifier rubyid_silence'>silence</span><span class='lparen'>(</span><span class='id identifier rubyid_filtered'>filtered</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='symbol'>:noise</span>
    <span class='id identifier rubyid_noise'>noise</span><span class='lparen'>(</span><span class='id identifier rubyid_filtered'>filtered</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_filtered'>filtered</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_filters!-instance_method">
  
    #<strong>remove_filters!</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Removes all filters, but leaves in the silencers. Useful if you suddenly
need to see entire filepaths in the backtrace that you had already
filtered out.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_backtrace_cleaner/backtrace_cleaner.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_filters!'>remove_filters!</span>
  <span class='ivar'>@filters</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_silencers!-instance_method">
  
    #<strong>remove_silencers!</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Removes all silencers, but leaves in the filters. Useful if your
context of debugging suddenly expands as you suspect a bug in one of
the libraries you use.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_backtrace_cleaner/backtrace_cleaner.rb', line 91</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_silencers!'>remove_silencers!</span>
  <span class='ivar'>@silencers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sun Apr 23 20:17:53 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.1.4).
</div>

    </div>
  </body>
</html>