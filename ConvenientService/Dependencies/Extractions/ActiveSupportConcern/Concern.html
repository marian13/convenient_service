<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: ConvenientService::Dependencies::Extractions::ActiveSupportConcern::Concern
  
    &mdash; Documentation by YARD 0.9.38
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "ConvenientService::Dependencies::Extractions::ActiveSupportConcern::Concern";
  relpath = '../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../ConvenientService.html" title="ConvenientService (module)">ConvenientService</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Dependencies.html" title="ConvenientService::Dependencies (module)">Dependencies</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Extractions.html" title="ConvenientService::Dependencies::Extractions (module)">Extractions</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../ActiveSupportConcern.html" title="ConvenientService::Dependencies::Extractions::ActiveSupportConcern (module)">ActiveSupportConcern</a></span></span>
     &raquo; 
    <span class="title">Concern</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: ConvenientService::Dependencies::Extractions::ActiveSupportConcern::Concern
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>A typical module looks like this:</p>
<p>module M
def self.included(base)
base.extend ClassMethods
base.class_eval do
scope :disabled, -&gt; { where(disabled: true) }
end
end</p>
<pre class="code ruby"><code class="ruby">module ClassMethods
  ...
end
</code></pre>
<p>end</p>
<p>By using <!-- raw HTML omitted -->ActiveSupport::Concern<!-- raw HTML omitted --> the above module could instead be
written as:</p>
<p>require &quot;active_support/concern&quot;</p>
<p>module M
extend ActiveSupport::Concern</p>
<pre class="code ruby"><code class="ruby">included do
  scope :disabled, -&gt; { where(disabled: true) }
end

class_methods do
  ...
end
</code></pre>
<p>end</p>
<p>Moreover, it gracefully handles module dependencies. Given a +Foo+ module
and a +Bar+ module which depends on the former, we would typically write the
following:</p>
<p>module Foo
def self.included(base)
base.class_eval do
def self.method_injected_by_foo
...
end
end
end
end</p>
<p>module Bar
def self.included(base)
base.method_injected_by_foo
end
end</p>
<p>class Host
include Foo # We need to include this dependency for Bar
include Bar # Bar is the module that Host really needs
end</p>
<p>But why should +Host+ care about +Bar+'s dependencies, namely +Foo+? We
could try to hide these from +Host+ directly including +Foo+ in +Bar+:</p>
<p>module Bar
include Foo
def self.included(base)
base.method_injected_by_foo
end
end</p>
<p>class Host
include Bar
end</p>
<p>Unfortunately this won't work, since when +Foo+ is included, its <!-- raw HTML omitted -->base<!-- raw HTML omitted -->
is the +Bar+ module, not the +Host+ class. With <!-- raw HTML omitted -->ActiveSupport::Concern<!-- raw HTML omitted -->,
module dependencies are properly resolved:</p>
<p>require &quot;active_support/concern&quot;</p>
<p>module Foo
extend ActiveSupport::Concern
included do
def self.method_injected_by_foo
...
end
end
end</p>
<p>module Bar
extend ActiveSupport::Concern
include Foo</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_included'>included</span> <span class='kw'>do</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_method_injected_by_foo'>method_injected_by_foo</span>
<span class='kw'>end</span>
</code></pre>
<p>end</p>
<p>class Host
include Bar # It works, now Bar takes care of its dependencies
end</p>
<p>=== Prepending concerns</p>
<p>Just like <!-- raw HTML omitted -->include<!-- raw HTML omitted -->, concerns also support <!-- raw HTML omitted -->prepend<!-- raw HTML omitted --> with a corresponding
<!-- raw HTML omitted -->prepended do<!-- raw HTML omitted --> callback. <!-- raw HTML omitted -->module ClassMethods<!-- raw HTML omitted --> or <!-- raw HTML omitted -->class_methods do<!-- raw HTML omitted --> are
prepended as well.</p>
<p><!-- raw HTML omitted -->prepend<!-- raw HTML omitted --> is also used for any dependencies.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="https://apidocs.convenientservice.org/ConvenientService/Dependencies/Extractions/ActiveSupportConcern/Concern/MultipleIncludedBlocks.html" title="ConvenientService::Dependencies::Extractions::ActiveSupportConcern::Concern::MultipleIncludedBlocks (class)">MultipleIncludedBlocks</a></span>, <span class='object_link'><a href="https://apidocs.convenientservice.org/ConvenientService/Dependencies/Extractions/ActiveSupportConcern/Concern/MultiplePrependBlocks.html" title="ConvenientService::Dependencies::Extractions::ActiveSupportConcern::Concern::MultiplePrependBlocks (class)">MultiplePrependBlocks</a></span>
    
  
</p>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extended-class_method" title="extended (class method)">.<strong>extended</strong>(base)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>:nodoc:.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#append_features-instance_method" title="#append_features (instance method)">#<strong>append_features</strong>(base)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>:nodoc:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#class_methods-instance_method" title="#class_methods (instance method)">#<strong>class_methods</strong>(&amp;class_methods_module_definition)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Define class methods from given block.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#included-instance_method" title="#included (instance method)">#<strong>included</strong>(base = nil, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Evaluate given block in context of base class, so that you can write class macros here.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#instance_methods-instance_method" title="#instance_methods (instance method)">#<strong>instance_methods</strong>(include_private = false, &amp;instance_methods_module_definition)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>NOTE: Customization compared to original <code>Concern</code> implementation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepend_features-instance_method" title="#prepend_features (instance method)">#<strong>prepend_features</strong>(base)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>:nodoc:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepended-instance_method" title="#prepended (instance method)">#<strong>prepended</strong>(base = nil, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Evaluate given block in context of base class, so that you can write class macros here.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#singleton_class_methods-instance_method" title="#singleton_class_methods (instance method)">#<strong>singleton_class_methods</strong>(&amp;singleton_class_methods_module_definition)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Define singleton class methods from given block.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="extended-class_method">
  
    .<strong>extended</strong>(base)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>:nodoc:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb', line 156</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_extended'>extended</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='symbol'>:@_dependencies</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="append_features-instance_method">
  
    #<strong>append_features</strong>(base)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>:nodoc:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_append_features'>append_features</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_defined?'>instance_variable_defined?</span><span class='lparen'>(</span><span class='symbol'>:@_dependencies</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span><span class='symbol'>:@_dependencies</span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
    <span class='kw'>false</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span> <span class='op'>&lt;</span> <span class='kw'>self</span>
    <span class='ivar'>@_dependencies</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_dep'>dep</span><span class='op'>|</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_include'>include</span><span class='lparen'>(</span><span class='id identifier rubyid_dep'>dep</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>super</span>

    <span class='id identifier rubyid_eval_included_block'>eval_included_block</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='rparen'>)</span>

    <span class='comment'>##
</span>    <span class='comment'># NOTE: Customization compared to original `Concern` implementation.
</span>    <span class='comment'># TODO: Why original `Concern` implementation uses `const_defined?(:ClassMethods)`, not `const_defined?(:ClassMethods, false)`?
</span>    <span class='comment'># NOTE: Changed order to have a way to control when to include `InstanceMethods` and `ClassMethods` from `included` block.
</span>    <span class='comment'>#
</span>    <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_include'>include</span> <span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:InstanceMethods</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:InstanceMethods</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_extend'>extend</span> <span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:ClassMethods</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:ClassMethods</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_singleton_class'>singleton_class</span><span class='period'>.</span><span class='id identifier rubyid_extend'>extend</span> <span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:SingletonClassMethods</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:SingletonClassMethods</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="class_methods-instance_method">
  
    #<strong>class_methods</strong>(&amp;class_methods_module_definition)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Define class methods from given block.
You can define private class methods as well.</p>
<p>module Example
extend ActiveSupport::Concern</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_class_methods'>class_methods</span> <span class='kw'>do</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span><span class='semicolon'>;</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>
    <span class='kw'>def</span> <span class='id identifier rubyid_bar'>bar</span><span class='semicolon'>;</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&#39;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>
<p>end</p>
<p>class Buzz
include Example
end</p>
<p>Buzz.foo # =&gt; &quot;foo&quot;
Buzz.bar # =&gt; private method 'bar' called for Buzz:Class(NoMethodError)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


276
277
278
279
280
281
282</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb', line 276</span>

<span class='kw'>def</span> <span class='id identifier rubyid_class_methods'>class_methods</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_class_methods_module_definition'>class_methods_module_definition</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mod'>mod</span> <span class='op'>=</span> <span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:ClassMethods</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='op'>?</span>
    <span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:ClassMethods</span><span class='rparen'>)</span> <span class='op'>:</span>
    <span class='id identifier rubyid_const_set'>const_set</span><span class='lparen'>(</span><span class='symbol'>:ClassMethods</span><span class='comma'>,</span> <span class='const'>Module</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_mod'>mod</span><span class='period'>.</span><span class='id identifier rubyid_module_eval'>module_eval</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_class_methods_module_definition'>class_methods_module_definition</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="included-instance_method">
  
    #<strong>included</strong>(base = nil, &amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Evaluate given block in context of base class,
so that you can write class macros here.
When you define more than one +included+ block, it raises an exception.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


209
210
211
212
213
214
215
216
217
218
219
220
221</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb', line 209</span>

<span class='kw'>def</span> <span class='id identifier rubyid_included'>included</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_instance_variable_defined?'>instance_variable_defined?</span><span class='lparen'>(</span><span class='symbol'>:@_included_block</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='ivar'>@_included_block</span><span class='period'>.</span><span class='id identifier rubyid_source_location'>source_location</span> <span class='op'>!=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_source_location'>source_location</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="https://apidocs.convenientservice.org/ConvenientService/Dependencies/Extractions/ActiveSupportConcern/Concern/MultipleIncludedBlocks.html" title="ConvenientService::Dependencies::Extractions::ActiveSupportConcern::Concern::MultipleIncludedBlocks (class)">MultipleIncludedBlocks</a></span></span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='ivar'>@_included_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="instance_methods-instance_method">
  
    #<strong>instance_methods</strong>(include_private = false, &amp;instance_methods_module_definition)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>NOTE: Customization compared to original <code>Concern</code> implementation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245
246
247
248
249
250
251
252
253
254</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb', line 243</span>

<span class='kw'>def</span> <span class='id identifier rubyid_instance_methods'>instance_methods</span><span class='lparen'>(</span><span class='id identifier rubyid_include_private'>include_private</span> <span class='op'>=</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_instance_methods_module_definition'>instance_methods_module_definition</span><span class='rparen'>)</span>
  <span class='comment'>##
</span>  <span class='comment'># NOTE: This `if` is propably the reason why Rails team decided to create only `class_methods` in the original Concern implementation.
</span>  <span class='comment'>#
</span>  <span class='kw'>return</span> <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_include_private'>include_private</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_instance_methods_module_definition'>instance_methods_module_definition</span>

  <span class='id identifier rubyid_mod'>mod</span> <span class='op'>=</span> <span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:InstanceMethods</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='op'>?</span>
    <span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:InstanceMethods</span><span class='rparen'>)</span> <span class='op'>:</span>
    <span class='id identifier rubyid_const_set'>const_set</span><span class='lparen'>(</span><span class='symbol'>:InstanceMethods</span><span class='comma'>,</span> <span class='const'>Module</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_mod'>mod</span><span class='period'>.</span><span class='id identifier rubyid_module_eval'>module_eval</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_instance_methods_module_definition'>instance_methods_module_definition</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepend_features-instance_method">
  
    #<strong>prepend_features</strong>(base)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>:nodoc:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb', line 184</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepend_features'>prepend_features</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_defined?'>instance_variable_defined?</span><span class='lparen'>(</span><span class='symbol'>:@_dependencies</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span><span class='symbol'>:@_dependencies</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span> <span class='kw'>self</span>
    <span class='kw'>false</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span> <span class='op'>&lt;</span> <span class='kw'>self</span>
    <span class='ivar'>@_dependencies</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_dep'>dep</span><span class='op'>|</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_prepend'>prepend</span><span class='lparen'>(</span><span class='id identifier rubyid_dep'>dep</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>super</span>

    <span class='id identifier rubyid_eval_prepended_block'>eval_prepended_block</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='rparen'>)</span>

    <span class='comment'>##
</span>    <span class='comment'># NOTE: Customization compared to original `Concern` implementation.
</span>    <span class='comment'># TODO: Why original `Concern` implementation uses `const_defined?(:ClassMethods)`, not `const_defined?(:ClassMethods, false)`?
</span>    <span class='comment'># NOTE: Changed order to have a way to control when to include `InstanceMethods` and `ClassMethods` from `included` block.
</span>    <span class='comment'>#
</span>    <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_prepend'>prepend</span> <span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:InstanceMethods</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:InstanceMethods</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_singleton_class'>singleton_class</span><span class='period'>.</span><span class='id identifier rubyid_prepend'>prepend</span> <span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:ClassMethods</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:ClassMethods</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepended-instance_method">
  
    #<strong>prepended</strong>(base = nil, &amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Evaluate given block in context of base class,
so that you can write class macros here.
When you define more than one +prepended+ block, it raises an exception.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


226
227
228
229
230
231
232
233
234
235
236
237
238</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb', line 226</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepended'>prepended</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_instance_variable_defined?'>instance_variable_defined?</span><span class='lparen'>(</span><span class='symbol'>:@_prepended_block</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='ivar'>@_prepended_block</span><span class='period'>.</span><span class='id identifier rubyid_source_location'>source_location</span> <span class='op'>!=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_source_location'>source_location</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="https://apidocs.convenientservice.org/ConvenientService/Dependencies/Extractions/ActiveSupportConcern/Concern/MultiplePrependBlocks.html" title="ConvenientService::Dependencies::Extractions::ActiveSupportConcern::Concern::MultiplePrependBlocks (class)">MultiplePrependBlocks</a></span></span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='ivar'>@_prepended_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="singleton_class_methods-instance_method">
  
    #<strong>singleton_class_methods</strong>(&amp;singleton_class_methods_module_definition)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Define singleton class methods from given block.
You can define private class methods as well.</p>
<p>module Example
extend ActiveSupport::Concern</p>
<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_singleton_class_methods'>singleton_class_methods</span> <span class='kw'>do</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span><span class='semicolon'>;</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&#39;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>
    <span class='kw'>def</span> <span class='id identifier rubyid_bar'>bar</span><span class='semicolon'>;</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&#39;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>
<p>end</p>
<p>class Buzz
include Example
end</p>
<p>Buzz.singleton_class.foo # =&gt; &quot;foo&quot;
Buzz.singleton_class.bar # =&gt; private method 'bar' called for Buzz:Class(NoMethodError)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


304
305
306
307
308
309
310</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/convenient_service/dependencies/extractions/active_support_concern/concern.rb', line 304</span>

<span class='kw'>def</span> <span class='id identifier rubyid_singleton_class_methods'>singleton_class_methods</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_singleton_class_methods_module_definition'>singleton_class_methods_module_definition</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mod'>mod</span> <span class='op'>=</span> <span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:SingletonClassMethods</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='op'>?</span>
    <span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:SingletonClassMethods</span><span class='rparen'>)</span> <span class='op'>:</span>
    <span class='id identifier rubyid_const_set'>const_set</span><span class='lparen'>(</span><span class='symbol'>:SingletonClassMethods</span><span class='comma'>,</span> <span class='const'>Module</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_mod'>mod</span><span class='period'>.</span><span class='id identifier rubyid_module_eval'>module_eval</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_singleton_class_methods_module_definition'>singleton_class_methods_module_definition</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Dec 22 23:59:22 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.38 (ruby-3.4.8).
</div>

    </div>
  </body>
</html>